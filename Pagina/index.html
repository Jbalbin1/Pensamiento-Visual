<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Prototipo ‚Äî Visualizaci√≥n de datos</title>
  <link rel="stylesheet" href="css/styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
  <script src="https://cdn.jsdelivr.net/npm/topojson-client@3"></script>
</head>
<body>
  <!-- Header compartido -->
  <div id="header-placeholder"></div>
  <script>
    fetch("header.html")
      .then(res => res.text())
      .then(html => {
        document.getElementById("header-placeholder").innerHTML = html;

        // === Scroll-spy: resalta el bot√≥n seg√∫n secci√≥n visible ===
        const sections = [
          document.getElementById("inicio"),
          document.getElementById("stats"),
          document.getElementById("motivacion"),
        ].filter(Boolean);

        const linkMap = new Map();
        // Mapea href -> <a>
        document.querySelectorAll('.topbar .nav .btn').forEach(a => {
          const hash = (a.getAttribute('href') || '').split('#')[1];
          if (hash && document.getElementById(hash)) linkMap.set(hash, a);
        });

        const setActive = (id) => {
          document.querySelectorAll('.topbar .nav .btn').forEach(a => a.classList.remove('is-active'));
          const btn = linkMap.get(id);
          if (btn) btn.classList.add('is-active');
        };

        // Observa qu√© secci√≥n est√° en viewport
        const obs = new IntersectionObserver((entries) => {
          // ordena por intersecci√≥n y escoge la m√°s visible
          const visible = entries
            .filter(e => e.isIntersecting)
            .sort((a,b) => b.intersectionRatio - a.intersectionRatio)[0];
          if (visible) setActive(visible.target.id);
        }, { rootMargin: '-20% 0px -60% 0px', threshold: [0.25, 0.6, 0.9] });

        sections.forEach(sec => obs.observe(sec));

        // Al hacer click, marcar al tiro (mejor UX)
        document.querySelectorAll('.topbar .nav .btn[href*="#"]').forEach(a => {
          a.addEventListener('click', () => {
            const id = a.getAttribute('href').split('#')[1];
            if (id) setActive(id);
          });
        });
      });
  </script>

<section id="inicio" class="section hero">
  <div class="container">

    <h1>¬øQu√© buscamos?</h1>
    <p class="lead">
      Que al explorar estos datos <strong>te hagas preguntas</strong>, 
      <strong>converses</strong> y <strong>mires tu entorno con otros ojos</strong>.
      Queremos una ciudadan√≠a joven m√°s <em>cr√≠tica, emp√°tica</em> y con ganas de participar.
    </p>

    <div class="callout">
      <p><strong>En simple:</strong> no es solo ‚Äúinformar‚Äù, es <strong>mover</strong> a la reflexi√≥n y al compromiso.</p>
    </div>

    <h2>¬øPor qu√©?</h2>
    <ul class="hero-list">
      <li> Muchos adolescentes y j√≥venes perciben los problemas sociales como algo <strong>ajeno o inevitable</strong>, 
        cuando en realidad influyen directamente en su calidad de vida y en la de sus comunidades.
      <li>trav√©s de esta visualizaci√≥n buscamos traducir datos complejos en <strong>informaci√≥n clara y significativa</strong>, 
        que les permita <strong>entender, cuestionar y conversar</strong> sobre los factores que afectan el bienestar colectivo, 
        fomentando as√≠ una ciudadan√≠a m√°s consciente y emp√°tica.</li>
    </ul>

    <h2>¬øQu√© es la satisfacci√≥n de la vida?</h2>
    <p>
      La satisfacci√≥n de la vida es una medida subjetiva de c√≥mo la persona valora su 
      existencia en el momento, usualmente tomando en consideraci√≥n factores de <strong>salud, seguridad, felicidad, entre otros.</strong>
    </p>
  </div>
</section>


  <main class="grid" id="stats">
  
    <div id="DelitosVIFSatisfacci√≥n">
      <h1>Delitos, VIF y Satisfacci√≥n:</h1>
      <div class="controls">
        <label for="yearSel"></label>
        <select id="yearSel"></select>
      </div>
    </div>

    <section class="panel">
      <div id="MapaRegion">
        <h2>Mapa por satisfacci√≥n</h2>
      </div>
      <div class="stage">
        <svg id="mapSvg" viewBox="0 0 700 1000" preserveAspectRatio="xMidYMid meet">
          <g id="mapGroup"></g>
        </svg>
      </div>
    </section>

    <section class="panel">
      <div id="Mapaburbujas">
        <h2>Delitos vs VIF (burbujas)</h2>
      </div>
      <div class="stage">
        <svg id="bubbleSvg" viewBox="0 0 900 600" preserveAspectRatio="xMidYMid meet"></svg>
      </div>
    </section>

    <section class="panel panel-detail">
      <div id="detailBox" class="detail-box" hidden>
        <h1 id="detailTitle">Detalle ‚Äî Regi√≥n</h1>

        <!-- regi√≥n duplicada (m√°s peque√±a) -->
        <svg id="detailRegionSvg" width="220" height="140"></svg>

        <!-- KPIs principales -->
        <div class="kpi-row">
          <div class="kpi">
            <div class="icon">üòä</div>
            <div class="value" id="satValue">‚Äî</div>
            <div class="sub">Satisfacci√≥n</div>
            <div class="rank" id="satRank">‚Äî</div>
          </div>
          <div class="kpi">
            <div class="icon">üè†</div>
            <div class="value" id="vifValue">‚Äî</div>
            <div class="sub">VIF</div>
            <div class="rank" id="vifRank">‚Äî</div>
          </div>
          <div class="kpi">
            <div class="icon">üîó</div>
            <div class="value" id="delValue">‚Äî</div>
            <div class="sub">Delitos</div>
            <div class="rank" id="delRank">‚Äî</div>
          </div>
        </div>

        <!-- 2 tarjetas: VIF desglosado y delitos estudiados -->
        <div class="cards-2">
          <div class="card">
            <h4>Violencia intrafamiliar</h4>
            <div class="pill">
              <span>Psicol√≥gica</span>
              <strong id="vifPsico">‚Äî</strong>
            </div>
            <div class="pill">
              <span>F√≠sica</span>
              <strong id="vifFisica">‚Äî</strong>
            </div>
          </div>

          <div class="card">
            <h4>Delitos estudiados</h4>
            <ul id="delitosList" class="bullets"></ul>
          </div>
        </div>

        <button id="closeDetail" class="close-detail">Cerrar</button>
      </div>
    </section>

  </main>
<section id="motivacion" class="section motivation">
  <div class="container">
    <h2>¬øQu√© puedo hacer como individuo?</h2>

    <div class="tips tips-big">
      <div class="tip">
        <h3>1) Habla del tema</h3>
        <p>Conversar de VIF y delitos <strong>rompe el silencio</strong> y ayuda a ver se√±ales a tiempo.</p>
      </div>
      <div class="tip">
        <h3>2) Arma red</h3>
        <p>Escucha sin juzgar, comparte informaci√≥n de ayuda y acompa√±a. <strong>No est√°s sol@.</strong></p>
      </div>
      <div class="tip">
        <h3>3) Participa</h3>
        <p>Centro de estudiantes, juntas, campa√±as locales. <strong>Peque√±as acciones = grandes cambios.</strong></p>
      </div>
      <div class="tip">
        <h3>4) Respeto siempre</h3>
        <p>L√≠mites sanos, empat√≠a, cero tolerancia a la violencia. <strong>Parte por tu c√≠rculo.</strong></p>
      </div>
      <div class="tip">
        <h3>5) Denuncia responsable</h3>
        <p>Si hay riesgo, <strong>busca apoyo adulto</strong>, autoridades o l√≠neas de ayuda.</p>
      </div>
    </div>

    <div class="cta-row">
      <p class="cta-text">La informaci√≥n es poder cuando se vuelve <strong>acci√≥n</strong>.</p>
    </div>
  </div>
</section>
  <script src="js/bubbles.js"></script>
  <script src="js/map.js"></script>
  <script src="js/main.js"></script>
</body>
</html>
